<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>海綿寶寶圖片搜尋</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: #202124;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 100px;
        }
        
        .logo {
            width: 272px;
            margin-bottom: 20px;
        }
        
        .search-container {
            width: 100%;
            max-width: 584px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .search-box {
            display: flex;
            height: 46px;
            border: 1px solid #dfe1e5;
            border-radius: 24px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            padding: 0 15px;
            margin-bottom: 20px;
            background-color: white;
            transition: box-shadow 200ms ease;
        }
        
        .search-box:hover,
        .search-box:focus-within {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-color: rgba(223, 225, 229, 0);
        }
        
        .search-input {
            flex-grow: 1;
            height: 100%;
            border: none;
            outline: none;
            font-size: 16px;
            color: #202124;
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            gap: 12px;
        }
        
        .option-button {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
            color: #202124;
            border: 1px solid #dadce0;
            border-radius: 4px;
            font-size: 14px;
            padding: 10px 16px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .option-button:hover {
            background-color: #f1f3f4;
            box-shadow: 0 1px 3px rgba(60, 64, 67, 0.1);
        }
        
        .option-button svg {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            fill: #5f6368;
        }
        
        .search-button {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            padding: 10px 16px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .search-button:hover {
            background-color: #357ae8;
        }
        
        .search-button svg {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            fill: white;
        }
        
        .advanced-options {
            margin-top: 25px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 0;
            display: none;
            animation: slideDown 0.3s ease;
            overflow: hidden;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .advanced-header {
            background-color: #4285f4;
            color: white;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .advanced-header svg {
            width: 20px;
            height: 20px;
            fill: white;
        }
        
        .advanced-content {
            padding: 20px;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .option-group {
            margin-bottom: 20px;
        }
        
        .option-label {
            display: block;
            font-size: 14px;
            color: #202124;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .option-description {
            font-size: 12px;
            color: #5f6368;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .option-input {
            width: 100%;
            padding: 10px 12px;
            font-size: 14px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            color: #202124;
            transition: border 0.2s;
        }
        
        .option-input:focus {
            border-color: #4285f4;
            outline: none;
        }
        
        .option-select {
            width: 100%;
            padding: 10px 12px;
            font-size: 14px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            color: #202124;
            background-color: white;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='%235F6368'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            transition: border 0.2s;
        }
        
        .option-select:focus {
            border-color: #4285f4;
            outline: none;
        }
        
        .toggle-container {
            position: relative;
            display: inline-block;
            width: 46px;
            height: 24px;
        }
        
        .toggle-input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        .toggle-input:checked + .toggle-slider {
            background-color: #4285f4;
        }
        
        .toggle-input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .toggle-text {
            margin-left: 12px;
            font-size: 14px;
            color: #202124;
        }
        
        .results-container {
            margin-top: 30px;
            padding: 0 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .image-result {
            max-width: 100%;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .image-info {
            margin-top: 10px;
            text-align: center;
            color: #5f6368;
            font-size: 14px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1200px;
        }
        
        .grid-item {
            display: flex;
            flex-direction: column;
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .grid-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .grid-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .grid-info {
            padding: 15px;
        }
        
        .grid-code {
            font-weight: 500;
            color: #202124;
        }
        
        .grid-text {
            margin-top: 5px;
            font-size: 14px;
            color: #5f6368;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .loading {
            display: none;
            margin: 30px 0;
            text-align: center;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(66, 133, 244, 0.2);
            border-radius: 50%;
            border-top-color: #4285f4;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        footer {
            margin-top: auto;
            padding: 20px;
            background-color: #f2f2f2;
            border-top: 1px solid #dadce0;
            color: #70757a;
            font-size: 14px;
            text-align: center;
        }
        
        .error-message {
            display: none;
            color: #d93025;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            background-color: rgba(217, 48, 37, 0.05);
            padding: 10px 15px;
            border-radius: 8px;
            border-left: 4px solid #d93025;
        }

        @media (max-width: 768px) {
            .logo {
                width: 200px;
            }
            
            .logo-container {
                margin-top: 60px;
            }
            
            .results-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .button-container {
                flex-direction: column;
            }
            
            .option-button, 
            .search-button {
                width: 100%;
            }
        }
        
        /* 現有樣式保持不變 */
        
        /* 新增分頁控制樣式 */
        .pagination-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .page-button {
            background-color: #f8f9fa;
            border: 1px solid #dadce0;
            color: #202124;
            padding: 8px 12px;
            margin: 0 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .page-button:hover {
            background-color: #f1f3f4;
            box-shadow: 0 1px 3px rgba(60, 64, 67, 0.1);
        }
        
        .page-button.active {
            background-color: #4285f4;
            color: white;
            border-color: #4285f4;
        }
        
        .page-info {
            margin: 0 15px;
            color: #5f6368;
            font-size: 14px;
        }
        
        .results-summary {
            text-align: center;
            margin-bottom: 15px;
            color: #5f6368;
            font-size: 14px;
        }
        
        .load-more-button {
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            padding: 10px 20px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .load-more-button:hover {
            background-color: #357ae8;
        }

    </style>
</head>
<body>
    <div class="logo-container">
        <img src="image/SS8178.jpg" alt="海綿寶寶搜尋" class="logo">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="輸入關鍵字或圖片編號...">
            </div>
            
            <div class="button-container">
                <button class="search-button" id="searchButton">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                    </svg>
                    搜尋圖片
                </button>
                
                <button class="option-button" id="toggleAdvanced">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                    </svg>
                    進階選項
                </button>
                
                <button class="option-button" id="randomButton">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
                    </svg>
                    隨機圖片
                </button>
            </div>
            
            <div class="advanced-options" id="advancedOptions">
                <div class="advanced-header">
                    <span>進階搜尋選項</span>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58z"/>
                    </svg>
                </div>
                
                <div class="advanced-content">
                    <div class="options-grid">
                        <div class="option-group">
                            <label class="option-label">模糊匹配程度</label>
                            <div class="option-description">控制搜尋時的匹配要求嚴格程度</div>
                            <select class="option-select" id="fuzzyLevel">
                                <option value="medium">中等 (包含連續子字串)</option>
                                <option value="strict">嚴格 (完全匹配)</option>
                                <option value="loose">寬鬆 (包含所有字元)</option>
                            </select>
                        </div>
                        
                        <div class="option-group">
                            <label class="option-label">結果數量</label>
                            <div class="option-description">設定返回的圖片數量</div>
                            <input type="number" class="option-input" id="limitInput" min="1" max="5000" value="5000">
                        </div>
                    </div>
                    
                    <div class="option-group">
                        <label class="toggle-label">
                            <div class="toggle-container">
                                <input type="checkbox" class="toggle-input" id="directLinkCheckbox">
                                <span class="toggle-slider"></span>
                            </div>
                            <span class="toggle-text">直接返回圖片連結 (不顯示圖片內容)</span>
                        </label>
                        <div class="option-description" style="margin-left: 58px; margin-top: 5px;">
                            開啟此選項將在新視窗中直接打開圖片，而不是在此頁面顯示
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="error-message" id="errorMessage"></div>
    
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <div>載入中...</div>
    </div>
    
    <div class="results-container" id="resultsContainer"></div>
    
    <footer>
        © 2025 海綿寶寶圖片搜尋 - 資料來源: potatomatoyota
    </footer>

    <script>
      const API_BASE_URL = 'https://spongebob.potatomatoyota.workers.dev';
      
      // 獲取DOM元素
      const searchInput = document.getElementById('searchInput');
      const searchButton = document.getElementById('searchButton');
      const randomButton = document.getElementById('randomButton');
      const toggleAdvancedButton = document.getElementById('toggleAdvanced');
      const advancedOptions = document.getElementById('advancedOptions');
      const fuzzyLevel = document.getElementById('fuzzyLevel');
      const limitInput = document.getElementById('limitInput');
      const directLinkCheckbox = document.getElementById('directLinkCheckbox');
      const resultsContainer = document.getElementById('resultsContainer');
      const errorMessage = document.getElementById('errorMessage');
      const loading = document.getElementById('loading');
      
      // 分頁相關變數
      let currentResults = [];
      let currentQuery = '';
      let currentPage = 1;
      const resultsPerPage = 30; // 每頁顯示數量
      let totalResults = 0;
      
      // 切換進階選項顯示
      toggleAdvancedButton.addEventListener('click', () => {
          const isHidden = advancedOptions.style.display === 'none' || advancedOptions.style.display === '';
          advancedOptions.style.display = isHidden ? 'block' : 'none';
      });
      
      // 搜尋功能
      searchButton.addEventListener('click', () => {
          currentPage = 1;
          performSearch();
      });
      
      searchInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
              currentPage = 1;
              performSearch();
          }
      });
      
      // 隨機圖片功能
      randomButton.addEventListener('click', getRandomImage);
      
      function showLoading() {
          loading.style.display = 'block';
          errorMessage.style.display = 'none';
      }
      
      function hideLoading() {
          loading.style.display = 'none';
      }
      
      function showError(message) {
          errorMessage.textContent = message;
          errorMessage.style.display = 'block';
      }
      
      async function performSearch() {
          const query = searchInput.value.trim();
          currentQuery = query;
          
          if (!query) {
              showError('請輸入搜尋關鍵字或圖片編號');
              return;
          }
          
          showLoading();
          resultsContainer.innerHTML = '';
          
          const f = fuzzyLevel.value;
          let limit = parseInt(limitInput.value, 10) || 1;
          
          // 如果是顯示全部結果，將限制設為最大值5000
          if (limit > 50) {
              limit = 5000;
          }
          
          const dir = directLinkCheckbox.checked;
          
          // 檢查是否為編號搜尋 (SS開頭或純數字)
          const isCodeSearch = /^SS\d+/i.test(query) || /^\d+$/.test(query);
          
          let url;
          if (isCodeSearch) {
              url = `${API_BASE_URL}/image?code=${query}&limit=${limit}&dir=${dir}`;
          } else {
              url = `${API_BASE_URL}/image?search=${query}&f=${f}&limit=${limit}&dir=${dir}`;
          }
          
          try {
              // 如果是直接連結模式且限制為1，需要特殊處理
              if (dir && limit === 1) {
                  window.open(url, '_blank');
                  hideLoading();
                  return;
              }
              
              const response = await fetch(url);
              
              if (!response.ok) {
                  if (response.status === 404) {
                      showError(`找不到包含「${query}」的圖片`);
                  } else {
                      showError('搜尋過程中發生錯誤，請稍後再試');
                  }
                  hideLoading();
                  return;
              }
              
              // 檢查回應類型
              const contentType = response.headers.get('content-type');
              
              if (contentType && contentType.includes('image/')) {
                  // 顯示單張圖片
                  const blob = await response.blob();
                  const imageUrl = URL.createObjectURL(blob);
                  
                  resultsContainer.innerHTML = `
                      <img src="${imageUrl}" alt="搜尋結果" class="image-result">
                      <div class="image-info">搜尋詞: ${query}</div>
                  `;
              } else {
                  // 顯示多張圖片
                  const data = await response.json();
                  
                  if (data.results && data.results.length > 0) {
                      currentResults = data.results;
                      totalResults = currentResults.length;
                      
                      // 顯示分頁結果
                      displayResults();
                  } else {
                      showError('沒有找到符合的結果');
                  }
              }
          } catch (error) {
              showError('搜尋過程中發生錯誤');
              console.error('搜尋錯誤:', error);
          } finally {
              hideLoading();
          }
      }
      
      function displayResults() {
          // 計算當前頁應顯示的結果
          const startIndex = (currentPage - 1) * resultsPerPage;
          const endIndex = Math.min(startIndex + resultsPerPage, totalResults);
          const pageResults = currentResults.slice(startIndex, endIndex);
          
          // 創建結果摘要
          const summaryHTML = `
              <div class="results-summary">
                  找到 ${totalResults} 張圖片${currentQuery ? `，關鍵字「${currentQuery}」` : ''}
                  (顯示第 ${startIndex + 1} - ${endIndex} 張)
              </div>
          `;
          
          // 創建圖片網格
          const resultsHTML = `
              ${summaryHTML}
              <div class="results-grid">
                  ${pageResults.map(item => `
                      <div class="grid-item">
                          <img src="${item.url}" alt="${item.text}" loading="lazy">
                          <div class="grid-info">
                              <div class="grid-code">${item.code}</div>
                              <div class="grid-text">${item.text}</div>
                          </div>
                      </div>
                  `).join('')}
              </div>
          `;
          
          // 創建分頁控制
          const totalPages = Math.ceil(totalResults / resultsPerPage);
          
          let paginationHTML = '';
          if (totalPages > 1) {
              paginationHTML = `
                  <div class="pagination-controls">
                      <button class="page-button" onclick="changePage(1)" ${currentPage === 1 ? 'disabled' : ''}>
                          第一頁
                      </button>
                      <button class="page-button" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                          上一頁
                      </button>
                      
                      <span class="page-info">第 ${currentPage} 頁，共 ${totalPages} 頁</span>
                      
                      <button class="page-button" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                          下一頁
                      </button>
                      <button class="page-button" onclick="changePage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}>
                          最末頁
                      </button>
                  </div>
              `;
          }
          
          // 加載更多按鈕 (替代方案)
          const loadMoreHTML = totalPages > currentPage ? 
              `<button class="load-more-button" onclick="loadMore()">載入更多圖片</button>` : '';
          
          // 顯示結果
          resultsContainer.innerHTML = resultsHTML + paginationHTML + loadMoreHTML;
          
          // 滾動到頁面頂部 (除非是加載更多)
          if (!window.loadingMore) {
              window.scrollTo({ top: 0, behavior: 'smooth' });
          }
          window.loadingMore = false;
      }
      
      // 更改頁碼
      function changePage(page) {
          currentPage = page;
          displayResults();
      }
      
      // 載入更多結果
      function loadMore() {
          window.loadingMore = true;
          currentPage++;
          displayResults();
      }
      
      async function getRandomImage() {
          showLoading();
          resultsContainer.innerHTML = '';
          
          const limit = parseInt(limitInput.value, 10) || 1;
          // 如果限制超過50但不是要顯示全部結果，設為較合理的值
          const safeLimit = limit > 50 ? 100 : limit;
          
          const dir = directLinkCheckbox.checked;
          const url = `${API_BASE_URL}/image?random&limit=${safeLimit}&dir=${dir}`;
          
          currentQuery = ''; // 清空當前查詢
          
          try {
              // 如果是直接連結模式且限制為1，需要特殊處理
              if (dir && safeLimit === 1) {
                  window.open(url, '_blank');
                  hideLoading();
                  return;
              }
              
              const response = await fetch(url);
              
              if (!response.ok) {
                  showError('取得隨機圖片時發生錯誤，請稍後再試');
                  hideLoading();
                  return;
              }
              
              // 檢查回應類型
              const contentType = response.headers.get('content-type');
              
              if (contentType && contentType.includes('image/')) {
                  // 顯示單張圖片
                  const blob = await response.blob();
                  const imageUrl = URL.createObjectURL(blob);
                  
                  resultsContainer.innerHTML = `
                      <img src="${imageUrl}" alt="隨機圖片" class="image-result">
                      <div class="image-info">隨機海綿寶寶圖片</div>
                  `;
              } else {
                  // 顯示多張圖片
                  const data = await response.json();
                  
                  if (data.results && data.results.length > 0) {
                      currentResults = data.results;
                      totalResults = currentResults.length;
                      currentPage = 1;
                      
                      // 顯示分頁結果
                      displayResults();
                  } else {
                      showError('無法取得隨機圖片');
                  }
              }
          } catch (error) {
              showError('取得隨機圖片時發生錯誤');
              console.error('隨機圖片錯誤:', error);
          } finally {
              hideLoading();
          }
      }
  </script>
</body>
</html>